

<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
      bagit/bagit_profile.js - Documentation
  </title>

  <link href="https://www.braintreepayments.com/images/favicon-ccda0b14.png" rel="icon" type="image/png">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

  <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
  <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
  

  

  <!-- start Mixpanel -->
  <script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("1919205b2da72e4da3b9b6639b444d59");</script>
  <!-- end Mixpanel -->
</head>

<body>
  <svg style="display: none;">
    <defs>
      <symbol id="linkIcon" fill="#706d77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
          <path d="M0 0h24v24H0z" fill="none"/>
          <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>
      </symbol>
    </defs>
  </svg>

  <input type="checkbox" id="nav-trigger" class="nav-trigger" />
  <label for="nav-trigger" class="navicon-button x">
    <div class="navicon"></div>
  </label>

  <label for="nav-trigger" class="overlay"></label>

  <div class="top-nav-wrapper">
    <ul>
      <li >
        <a href="index.html">
          
            <svg fill="#6D6D6D" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
              <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
              <path d="M0 0h24v24H0z" fill="none"/>
            </svg>
          
          
        </a>
      </li>

      

    </ul>
  </div>

  <nav>
    <h3 class="reference-title">
      Braintree SDK Client Reference
    </h3>

    

    <h3>Classes</h3><ul><li id="AppSetting-nav"><a href="AppSetting.html">AppSetting</a><ul class='methods'><li data-type="method" id="AppSetting-validate-nav"><a href="AppSetting.html#validate">validate</a></li></ul></li><li id="APTrustClient-nav"><a href="APTrustClient.html">APTrustClient</a><ul class='methods'><li data-type="method" id="APTrustClient-description-nav"><a href="APTrustClient.html#.description">description</a></li></ul></li><li id="APTrustSetup-nav"><a href="APTrustSetup.html">APTrustSetup</a><ul class='methods'><li data-type="method" id="APTrustSetup-description-nav"><a href="APTrustSetup.html#.description">description</a></li><li data-type="method" id="APTrustSetup-_initFields-nav"><a href="APTrustSetup.html#_initFields">_initFields</a></li><li data-type="method" id="APTrustSetup-endMessage-nav"><a href="APTrustSetup.html#endMessage">endMessage</a></li><li data-type="method" id="APTrustSetup-postQuestionCallback-nav"><a href="APTrustSetup.html#postQuestionCallback">postQuestionCallback</a></li><li data-type="method" id="APTrustSetup-preQuestionCallback-nav"><a href="APTrustSetup.html#preQuestionCallback">preQuestionCallback</a></li><li data-type="method" id="APTrustSetup-startMessage-nav"><a href="APTrustSetup.html#startMessage">startMessage</a></li></ul></li><li id="Bagger-nav"><a href="Bagger.html">Bagger</a><ul class='methods'><li data-type="method" id="Bagger-_addPayloadFiles-nav"><a href="Bagger.html#_addPayloadFiles">_addPayloadFiles</a></li><li data-type="method" id="Bagger-create-nav"><a href="Bagger.html#create">create</a></li><li data-type="method" id="Bagger-validatePackagingOperation-nav"><a href="Bagger.html#validatePackagingOperation">validatePackagingOperation</a></li></ul></li><li id="BagItFile-nav"><a href="BagItFile.html">BagItFile</a><ul class='methods'><li data-type="method" id="BagItFile-getFileType-nav"><a href="BagItFile.html#.getFileType">getFileType</a></li><li data-type="method" id="BagItFile-getCryptoHash-nav"><a href="BagItFile.html#getCryptoHash">getCryptoHash</a></li><li data-type="method" id="BagItFile-getManifestEntry-nav"><a href="BagItFile.html#getManifestEntry">getManifestEntry</a></li><li data-type="method" id="BagItFile-isPayloadFile-nav"><a href="BagItFile.html#isPayloadFile">isPayloadFile</a></li><li data-type="method" id="BagItFile-isPayloadManifest-nav"><a href="BagItFile.html#isPayloadManifest">isPayloadManifest</a></li><li data-type="method" id="BagItFile-isTagFile-nav"><a href="BagItFile.html#isTagFile">isTagFile</a></li><li data-type="method" id="BagItFile-isTagManifest-nav"><a href="BagItFile.html#isTagManifest">isTagManifest</a></li></ul></li><li id="BagItProfile-nav"><a href="BagItProfile.html">BagItProfile</a><ul class='methods'><li data-type="method" id="BagItProfile-find-nav"><a href="BagItProfile.html#.find">find</a></li><li data-type="method" id="BagItProfile-fromJson-nav"><a href="BagItProfile.html#.fromJson">fromJson</a></li><li data-type="method" id="BagItProfile-inflateFrom-nav"><a href="BagItProfile.html#.inflateFrom">inflateFrom</a></li><li data-type="method" id="BagItProfile-load-nav"><a href="BagItProfile.html#.load">load</a></li><li data-type="method" id="BagItProfile-nameLooksLegal-nav"><a href="BagItProfile.html#.nameLooksLegal">nameLooksLegal</a></li><li data-type="method" id="BagItProfile-suggestGenericBagName-nav"><a href="BagItProfile.html#.suggestGenericBagName">suggestGenericBagName</a></li><li data-type="method" id="BagItProfile-bagDescription-nav"><a href="BagItProfile.html#bagDescription">bagDescription</a></li><li data-type="method" id="BagItProfile-bagInternalIdentifier-nav"><a href="BagItProfile.html#bagInternalIdentifier">bagInternalIdentifier</a></li><li data-type="method" id="BagItProfile-bagTitle-nav"><a href="BagItProfile.html#bagTitle">bagTitle</a></li><li data-type="method" id="BagItProfile-copyDefaultTagValuesFrom-nav"><a href="BagItProfile.html#copyDefaultTagValuesFrom">copyDefaultTagValuesFrom</a></li><li data-type="method" id="BagItProfile-findExactOrPartial-nav"><a href="BagItProfile.html#findExactOrPartial">findExactOrPartial</a></li><li data-type="method" id="BagItProfile-findMatchingTags-nav"><a href="BagItProfile.html#findMatchingTags">findMatchingTags</a></li><li data-type="method" id="BagItProfile-firstMatchingTag-nav"><a href="BagItProfile.html#firstMatchingTag">firstMatchingTag</a></li><li data-type="method" id="BagItProfile-getTagFileContents-nav"><a href="BagItProfile.html#getTagFileContents">getTagFileContents</a></li><li data-type="method" id="BagItProfile-getTagsFromFile-nav"><a href="BagItProfile.html#getTagsFromFile">getTagsFromFile</a></li><li data-type="method" id="BagItProfile-hasTagFile-nav"><a href="BagItProfile.html#hasTagFile">hasTagFile</a></li><li data-type="method" id="BagItProfile-isCustomTagFile-nav"><a href="BagItProfile.html#isCustomTagFile">isCustomTagFile</a></li><li data-type="method" id="BagItProfile-isValidBagName-nav"><a href="BagItProfile.html#isValidBagName">isValidBagName</a></li><li data-type="method" id="BagItProfile-mergeTagValues-nav"><a href="BagItProfile.html#mergeTagValues">mergeTagValues</a></li><li data-type="method" id="BagItProfile-mustBeTarred-nav"><a href="BagItProfile.html#mustBeTarred">mustBeTarred</a></li><li data-type="method" id="BagItProfile-suggestBagName-nav"><a href="BagItProfile.html#suggestBagName">suggestBagName</a></li><li data-type="method" id="BagItProfile-tagFileNames-nav"><a href="BagItProfile.html#tagFileNames">tagFileNames</a></li><li data-type="method" id="BagItProfile-tagsGroupedByFile-nav"><a href="BagItProfile.html#tagsGroupedByFile">tagsGroupedByFile</a></li><li data-type="method" id="BagItProfile-validate-nav"><a href="BagItProfile.html#validate">validate</a></li></ul></li><li id="BagItProfileController-nav"><a href="BagItProfileController.html">BagItProfileController</a><ul class='methods'><li data-type="method" id="BagItProfileController-_getPageHTML-nav"><a href="BagItProfileController.html#_getPageHTML">_getPageHTML</a></li><li data-type="method" id="BagItProfileController-create-nav"><a href="BagItProfileController.html#create">create</a></li><li data-type="method" id="BagItProfileController-deleteTagDef-nav"><a href="BagItProfileController.html#deleteTagDef">deleteTagDef</a></li><li data-type="method" id="BagItProfileController-edit-nav"><a href="BagItProfileController.html#edit">edit</a></li><li data-type="method" id="BagItProfileController-getNewProfileFromBase-nav"><a href="BagItProfileController.html#getNewProfileFromBase">getNewProfileFromBase</a></li><li data-type="method" id="BagItProfileController-new-nav"><a href="BagItProfileController.html#new">new</a></li><li data-type="method" id="BagItProfileController-newTagFile-nav"><a href="BagItProfileController.html#newTagFile">newTagFile</a></li><li data-type="method" id="BagItProfileController-newTagFileCreate-nav"><a href="BagItProfileController.html#newTagFileCreate">newTagFileCreate</a></li><li data-type="method" id="BagItProfileController-update-nav"><a href="BagItProfileController.html#update">update</a></li></ul></li><li id="BagItProfileForm-nav"><a href="BagItProfileForm.html">BagItProfileForm</a><ul class='methods'><li data-type="method" id="BagItProfileForm-_setProfileInfoFields-nav"><a href="BagItProfileForm.html#_setProfileInfoFields">_setProfileInfoFields</a></li><li data-type="method" id="BagItProfileForm-parseFromDOM-nav"><a href="BagItProfileForm.html#parseFromDOM">parseFromDOM</a></li></ul></li><li id="BagItProfileInfo-nav"><a href="BagItProfileInfo.html">BagItProfileInfo</a></li><li id="BagItUtil-nav"><a href="BagItUtil.html">BagItUtil</a><ul class='methods'><li data-type="method" id="BagItUtil-profileFromBuiltIn-nav"><a href="BagItUtil.html#.profileFromBuiltIn">profileFromBuiltIn</a></li><li data-type="method" id="BagItUtil-profileFromStandardJson-nav"><a href="BagItUtil.html#.profileFromStandardJson">profileFromStandardJson</a></li><li data-type="method" id="BagItUtil-profileFromStandardObject-nav"><a href="BagItUtil.html#.profileFromStandardObject">profileFromStandardObject</a></li></ul></li><li id="BaseController-nav"><a href="BaseController.html">BaseController</a><ul class='methods'><li data-type="method" id="BaseController-containerContent-nav"><a href="BaseController.html#containerContent">containerContent</a></li><li data-type="method" id="BaseController-destroy-nav"><a href="BaseController.html#destroy">destroy</a></li><li data-type="method" id="BaseController-edit-nav"><a href="BaseController.html#edit">edit</a></li><li data-type="method" id="BaseController-list-nav"><a href="BaseController.html#list">list</a></li><li data-type="method" id="BaseController-modalContent-nav"><a href="BaseController.html#modalContent">modalContent</a></li><li data-type="method" id="BaseController-new-nav"><a href="BaseController.html#new">new</a></li><li data-type="method" id="BaseController-noContent-nav"><a href="BaseController.html#noContent">noContent</a></li><li data-type="method" id="BaseController-openExternal-nav"><a href="BaseController.html#openExternal">openExternal</a></li><li data-type="method" id="BaseController-paramsToHash-nav"><a href="BaseController.html#paramsToHash">paramsToHash</a></li><li data-type="method" id="BaseController-postRenderCallback-nav"><a href="BaseController.html#postRenderCallback">postRenderCallback</a></li><li data-type="method" id="BaseController-redirect-nav"><a href="BaseController.html#redirect">redirect</a></li><li data-type="method" id="BaseController-update-nav"><a href="BaseController.html#update">update</a></li></ul></li><li id="DartProcess-nav"><a href="DartProcess.html">DartProcess</a></li><li id="DartProcessController-nav"><a href="DartProcessController.html">DartProcessController</a><ul class='methods'><li data-type="method" id="DartProcessController-list-nav"><a href="DartProcessController.html#list">list</a></li></ul></li><li id="DummyReader-nav"><a href="DummyReader.html">DummyReader</a><ul class='methods'><li data-type="method" id="DummyReader-_read-nav"><a href="DummyReader.html#_read">_read</a></li></ul></li><li id="FileStat-nav"><a href="FileStat.html">FileStat</a><ul class='methods'><li data-type="method" id="FileStat-isDirectory-nav"><a href="FileStat.html#isDirectory">isDirectory</a></li><li data-type="method" id="FileStat-isFile-nav"><a href="FileStat.html#isFile">isFile</a></li></ul></li><li id="FileSystemReader-nav"><a href="FileSystemReader.html">FileSystemReader</a><ul class='methods'><li data-type="method" id="FileSystemReader-description-nav"><a href="FileSystemReader.html#.description">description</a></li><li data-type="method" id="FileSystemReader-list-nav"><a href="FileSystemReader.html#list">list</a></li><li data-type="method" id="FileSystemReader-read-nav"><a href="FileSystemReader.html#read">read</a></li></ul></li><li id="FileSystemWriter-nav"><a href="FileSystemWriter.html">FileSystemWriter</a><ul class='methods'><li data-type="method" id="FileSystemWriter-description-nav"><a href="FileSystemWriter.html#.description">description</a></li><li data-type="method" id="FileSystemWriter-add-nav"><a href="FileSystemWriter.html#add">add</a></li></ul></li><li id="Form-nav"><a href="Form.html">Form</a><ul class='methods'><li data-type="method" id="Form-_initField-nav"><a href="Form.html#_initField">_initField</a></li><li data-type="method" id="Form-_initFields-nav"><a href="Form.html#_initFields">_initFields</a></li><li data-type="method" id="Form-castNewValueToType-nav"><a href="Form.html#castNewValueToType">castNewValueToType</a></li><li data-type="method" id="Form-hasErrors-nav"><a href="Form.html#hasErrors">hasErrors</a></li><li data-type="method" id="Form-parseFromDOM-nav"><a href="Form.html#parseFromDOM">parseFromDOM</a></li><li data-type="method" id="Form-setErrors-nav"><a href="Form.html#setErrors">setErrors</a></li></ul></li><li id="GlobalContext-nav"><a href="GlobalContext.html">GlobalContext</a><ul class='methods'><li data-type="method" id="GlobalContext-dartVersion-nav"><a href="GlobalContext.html#dartVersion">dartVersion</a></li><li data-type="method" id="GlobalContext-db-nav"><a href="GlobalContext.html#db">db</a></li><li data-type="method" id="GlobalContext-electronIsRunning-nav"><a href="GlobalContext.html#electronIsRunning">electronIsRunning</a></li><li data-type="method" id="GlobalContext-getPackageInfo-nav"><a href="GlobalContext.html#getPackageInfo">getPackageInfo</a></li><li data-type="method" id="GlobalContext-isElectronDevMode-nav"><a href="GlobalContext.html#isElectronDevMode">isElectronDevMode</a></li></ul></li><li id="InternalSetting-nav"><a href="InternalSetting.html">InternalSetting</a><ul class='methods'><li data-type="method" id="InternalSetting-validate-nav"><a href="InternalSetting.html#validate">validate</a></li></ul></li><li id="Job-nav"><a href="Job.html">Job</a><ul class='methods'><li data-type="method" id="Job-find-nav"><a href="Job.html#.find">find</a></li><li data-type="method" id="Job-inflateFrom-nav"><a href="Job.html#.inflateFrom">inflateFrom</a></li><li data-type="method" id="Job-inflateFromFile-nav"><a href="Job.html#.inflateFromFile">inflateFromFile</a></li><li data-type="method" id="Job-getRunErrors-nav"><a href="Job.html#getRunErrors">getRunErrors</a></li><li data-type="method" id="Job-packageAttempted-nav"><a href="Job.html#packageAttempted">packageAttempted</a></li><li data-type="method" id="Job-packagedAt-nav"><a href="Job.html#packagedAt">packagedAt</a></li><li data-type="method" id="Job-packageSucceeded-nav"><a href="Job.html#packageSucceeded">packageSucceeded</a></li><li data-type="method" id="Job-title-nav"><a href="Job.html#title">title</a></li><li data-type="method" id="Job-uploadAttempted-nav"><a href="Job.html#uploadAttempted">uploadAttempted</a></li><li data-type="method" id="Job-uploadedAt-nav"><a href="Job.html#uploadedAt">uploadedAt</a></li><li data-type="method" id="Job-uploadSucceeded-nav"><a href="Job.html#uploadSucceeded">uploadSucceeded</a></li><li data-type="method" id="Job-validate-nav"><a href="Job.html#validate">validate</a></li><li data-type="method" id="Job-validatedAt-nav"><a href="Job.html#validatedAt">validatedAt</a></li><li data-type="method" id="Job-validationAttempted-nav"><a href="Job.html#validationAttempted">validationAttempted</a></li><li data-type="method" id="Job-validationSucceeded-nav"><a href="Job.html#validationSucceeded">validationSucceeded</a></li></ul></li><li id="JobController-nav"><a href="JobController.html">JobController</a><ul class='methods'><li data-type="method" id="JobController-colorCodeJobs-nav"><a href="JobController.html#colorCodeJobs">colorCodeJobs</a></li><li data-type="method" id="JobController-list-nav"><a href="JobController.html#list">list</a></li><li data-type="method" id="JobController-new-nav"><a href="JobController.html#new">new</a></li></ul></li><li id="JobFilesController-nav"><a href="JobFilesController.html">JobFilesController</a><ul class='methods'><li data-type="method" id="JobFilesController-addFileToPackageSources-nav"><a href="JobFilesController.html#addFileToPackageSources">addFileToPackageSources</a></li><li data-type="method" id="JobFilesController-addItemsToUI-nav"><a href="JobFilesController.html#addItemsToUI">addItemsToUI</a></li><li data-type="method" id="JobFilesController-addItemToUI-nav"><a href="JobFilesController.html#addItemToUI">addItemToUI</a></li><li data-type="method" id="JobFilesController-addRow-nav"><a href="JobFilesController.html#addRow">addRow</a></li><li data-type="method" id="JobFilesController-attachDeleteEvents-nav"><a href="JobFilesController.html#attachDeleteEvents">attachDeleteEvents</a></li><li data-type="method" id="JobFilesController-attachDragAndDropEvents-nav"><a href="JobFilesController.html#attachDragAndDropEvents">attachDragAndDropEvents</a></li><li data-type="method" id="JobFilesController-findContainingItem-nav"><a href="JobFilesController.html#findContainingItem">findContainingItem</a></li><li data-type="method" id="JobFilesController-getTableRow-nav"><a href="JobFilesController.html#getTableRow">getTableRow</a></li><li data-type="method" id="JobFilesController-postRenderCallback-nav"><a href="JobFilesController.html#postRenderCallback">postRenderCallback</a></li><li data-type="method" id="JobFilesController-removeItemFromUI-nav"><a href="JobFilesController.html#removeItemFromUI">removeItemFromUI</a></li><li data-type="method" id="JobFilesController-show-nav"><a href="JobFilesController.html#show">show</a></li><li data-type="method" id="JobFilesController-updateTotal-nav"><a href="JobFilesController.html#updateTotal">updateTotal</a></li><li data-type="method" id="JobFilesController-updateTotals-nav"><a href="JobFilesController.html#updateTotals">updateTotals</a></li></ul></li><li id="JobMetadataController-nav"><a href="JobMetadataController.html">JobMetadataController</a><ul class='methods'><li data-type="method" id="JobMetadataController-_attachTagFileAutocomplete-nav"><a href="JobMetadataController.html#_attachTagFileAutocomplete">_attachTagFileAutocomplete</a></li><li data-type="method" id="JobMetadataController-_attachToggleHiddenTags-nav"><a href="JobMetadataController.html#_attachToggleHiddenTags">_attachToggleHiddenTags</a></li><li data-type="method" id="JobMetadataController-_parseMetadataForm-nav"><a href="JobMetadataController.html#_parseMetadataForm">_parseMetadataForm</a></li><li data-type="method" id="JobMetadataController-_validateMetadataForm-nav"><a href="JobMetadataController.html#_validateMetadataForm">_validateMetadataForm</a></li><li data-type="method" id="JobMetadataController-back-nav"><a href="JobMetadataController.html#back">back</a></li><li data-type="method" id="JobMetadataController-newTag-nav"><a href="JobMetadataController.html#newTag">newTag</a></li><li data-type="method" id="JobMetadataController-next-nav"><a href="JobMetadataController.html#next">next</a></li><li data-type="method" id="JobMetadataController-postRenderCallback-nav"><a href="JobMetadataController.html#postRenderCallback">postRenderCallback</a></li><li data-type="method" id="JobMetadataController-saveNewTag-nav"><a href="JobMetadataController.html#saveNewTag">saveNewTag</a></li><li data-type="method" id="JobMetadataController-show-nav"><a href="JobMetadataController.html#show">show</a></li></ul></li><li id="JobPackageOp-nav"><a href="JobPackageOp.html">JobPackageOp</a></li><li id="JobPackageOpForm-nav"><a href="JobPackageOpForm.html">JobPackageOpForm</a></li><li id="JobPackagingController-nav"><a href="JobPackagingController.html">JobPackagingController</a><ul class='methods'><li data-type="method" id="JobPackagingController-_parseJobPackagingForm-nav"><a href="JobPackagingController.html#_parseJobPackagingForm">_parseJobPackagingForm</a></li><li data-type="method" id="JobPackagingController-_renderPackagingForm-nav"><a href="JobPackagingController.html#_renderPackagingForm">_renderPackagingForm</a></li><li data-type="method" id="JobPackagingController-_updatePackaging-nav"><a href="JobPackagingController.html#_updatePackaging">_updatePackaging</a></li><li data-type="method" id="JobPackagingController-back-nav"><a href="JobPackagingController.html#back">back</a></li><li data-type="method" id="JobPackagingController-next-nav"><a href="JobPackagingController.html#next">next</a></li><li data-type="method" id="JobPackagingController-onFormatChange-nav"><a href="JobPackagingController.html#onFormatChange">onFormatChange</a></li><li data-type="method" id="JobPackagingController-postRenderCallback-nav"><a href="JobPackagingController.html#postRenderCallback">postRenderCallback</a></li><li data-type="method" id="JobPackagingController-show-nav"><a href="JobPackagingController.html#show">show</a></li></ul></li><li id="JobRunController-nav"><a href="JobRunController.html">JobRunController</a><ul class='methods'><li data-type="method" id="JobRunController-run-nav"><a href="JobRunController.html#run">run</a></li><li data-type="method" id="JobRunController-show-nav"><a href="JobRunController.html#show">show</a></li></ul></li><li id="JobStatus-nav"><a href="JobStatus.html">JobStatus</a></li><li id="JobTagsForm-nav"><a href="JobTagsForm.html">JobTagsForm</a><ul class='methods'><li data-type="method" id="JobTagsForm-_tagDefToField-nav"><a href="JobTagsForm.html#_tagDefToField">_tagDefToField</a></li></ul></li><li id="JobUploadController-nav"><a href="JobUploadController.html">JobUploadController</a><ul class='methods'><li data-type="method" id="JobUploadController-back-nav"><a href="JobUploadController.html#back">back</a></li><li data-type="method" id="JobUploadController-next-nav"><a href="JobUploadController.html#next">next</a></li><li data-type="method" id="JobUploadController-show-nav"><a href="JobUploadController.html#show">show</a></li></ul></li><li id="JobUploadForm-nav"><a href="JobUploadForm.html">JobUploadForm</a></li><li id="JsonStore-nav"><a href="JsonStore.html">JsonStore</a></li><li id="KeyValueCollection-nav"><a href="KeyValueCollection.html">KeyValueCollection</a><ul class='methods'><li data-type="method" id="KeyValueCollection-add-nav"><a href="KeyValueCollection.html#add">add</a></li><li data-type="method" id="KeyValueCollection-all-nav"><a href="KeyValueCollection.html#all">all</a></li><li data-type="method" id="KeyValueCollection-first-nav"><a href="KeyValueCollection.html#first">first</a></li><li data-type="method" id="KeyValueCollection-keys-nav"><a href="KeyValueCollection.html#keys">keys</a></li><li data-type="method" id="KeyValueCollection-sortedKeys-nav"><a href="KeyValueCollection.html#sortedKeys">sortedKeys</a></li></ul></li><li id="ManifestEntry-nav"><a href="ManifestEntry.html">ManifestEntry</a><ul class='methods'><li data-type="method" id="ManifestEntry-validate-nav"><a href="ManifestEntry.html#validate">validate</a></li></ul></li><li id="ManifestParser-nav"><a href="ManifestParser.html">ManifestParser</a></li><li id="NewBagItProfileForm-nav"><a href="NewBagItProfileForm.html">NewBagItProfileForm</a></li><li id="OperationResult-nav"><a href="OperationResult.html">OperationResult</a><ul class='methods'><li data-type="method" id="OperationResult-inflateFrom-nav"><a href="OperationResult.html#.inflateFrom">inflateFrom</a></li><li data-type="method" id="OperationResult-finish-nav"><a href="OperationResult.html#finish">finish</a></li><li data-type="method" id="OperationResult-firstError-nav"><a href="OperationResult.html#firstError">firstError</a></li><li data-type="method" id="OperationResult-hasErrors-nav"><a href="OperationResult.html#hasErrors">hasErrors</a></li><li data-type="method" id="OperationResult-lastError-nav"><a href="OperationResult.html#lastError">lastError</a></li><li data-type="method" id="OperationResult-reset-nav"><a href="OperationResult.html#reset">reset</a></li><li data-type="method" id="OperationResult-start-nav"><a href="OperationResult.html#start">start</a></li><li data-type="method" id="OperationResult-succeeded-nav"><a href="OperationResult.html#succeeded">succeeded</a></li></ul></li><li id="PackageOperation-nav"><a href="PackageOperation.html">PackageOperation</a><ul class='methods'><li data-type="method" id="PackageOperation-inflateFrom-nav"><a href="PackageOperation.html#.inflateFrom">inflateFrom</a></li><li data-type="method" id="PackageOperation-getWriter-nav"><a href="PackageOperation.html#getWriter">getWriter</a></li><li data-type="method" id="PackageOperation-pruneSourceFilesUnlessJobCompleted-nav"><a href="PackageOperation.html#pruneSourceFilesUnlessJobCompleted">pruneSourceFilesUnlessJobCompleted</a></li><li data-type="method" id="PackageOperation-validate-nav"><a href="PackageOperation.html#validate">validate</a></li></ul></li><li id="PersistentObject-nav"><a href="PersistentObject.html">PersistentObject</a><ul class='methods'><li data-type="method" id="PersistentObject-find-nav"><a href="PersistentObject.html#.find">find</a></li><li data-type="method" id="PersistentObject-findMatching-nav"><a href="PersistentObject.html#.findMatching">findMatching</a></li><li data-type="method" id="PersistentObject-first-nav"><a href="PersistentObject.html#.first">first</a></li><li data-type="method" id="PersistentObject-firstMatching-nav"><a href="PersistentObject.html#.firstMatching">firstMatching</a></li><li data-type="method" id="PersistentObject-list-nav"><a href="PersistentObject.html#.list">list</a></li><li data-type="method" id="PersistentObject-mergeDefaultOpts-nav"><a href="PersistentObject.html#.mergeDefaultOpts">mergeDefaultOpts</a></li><li data-type="method" id="PersistentObject-sort-nav"><a href="PersistentObject.html#.sort">sort</a></li><li data-type="method" id="PersistentObject-delete-nav"><a href="PersistentObject.html#delete">delete</a></li><li data-type="method" id="PersistentObject-save-nav"><a href="PersistentObject.html#save">save</a></li><li data-type="method" id="PersistentObject-validate-nav"><a href="PersistentObject.html#validate">validate</a></li></ul></li><li id="Plugin-nav"><a href="Plugin.html">Plugin</a><ul class='methods'><li data-type="method" id="Plugin-description-nav"><a href="Plugin.html#.description">description</a></li></ul></li><li id="PluginManager-nav"><a href="PluginManager.html">PluginManager</a><ul class='methods'><li data-type="method" id="PluginManager-canRead-nav"><a href="PluginManager.html#.canRead">canRead</a></li><li data-type="method" id="PluginManager-canWrite-nav"><a href="PluginManager.html#.canWrite">canWrite</a></li><li data-type="method" id="PluginManager-findById-nav"><a href="PluginManager.html#.findById">findById</a></li><li data-type="method" id="PluginManager-getModuleCollection-nav"><a href="PluginManager.html#.getModuleCollection">getModuleCollection</a></li><li data-type="method" id="PluginManager-implementsProtocol-nav"><a href="PluginManager.html#.implementsProtocol">implementsProtocol</a></li><li data-type="method" id="PluginManager-pluginProvides-nav"><a href="PluginManager.html#.pluginProvides">pluginProvides</a></li><li data-type="method" id="PluginManager-setsUp-nav"><a href="PluginManager.html#.setsUp">setsUp</a></li><li data-type="method" id="PluginManager-talksTo-nav"><a href="PluginManager.html#.talksTo">talksTo</a></li><li data-type="method" id="PluginManager-types-nav"><a href="PluginManager.html#.types">types</a></li></ul></li><li id="Popper-nav"><a href="Popper.html">Popper</a><ul class='methods'><li data-type="method" id="Popper-destroy-nav"><a href="Popper.html#.destroy">destroy</a></li><li data-type="method" id="Popper-disableEventListeners-nav"><a href="Popper.html#.disableEventListeners">disableEventListeners</a></li><li data-type="method" id="Popper-enableEventListeners-nav"><a href="Popper.html#.enableEventListeners">enableEventListeners</a></li><li data-type="method" id="Popper-placements-nav"><a href="Popper.html#.placements">placements</a></li><li data-type="method" id="Popper-update-nav"><a href="Popper.html#.update">update</a></li></ul></li><li id="RemoteRepository-nav"><a href="RemoteRepository.html">RemoteRepository</a><ul class='methods'><li data-type="method" id="RemoteRepository-validate-nav"><a href="RemoteRepository.html#validate">validate</a></li></ul></li><li id="S3Client-nav"><a href="S3Client.html">S3Client</a><ul class='methods'><li data-type="method" id="S3Client-description-nav"><a href="S3Client.html#.description">description</a></li><li data-type="method" id="S3Client-download-nav"><a href="S3Client.html#download">download</a></li><li data-type="method" id="S3Client-exists-nav"><a href="S3Client.html#exists">exists</a></li><li data-type="method" id="S3Client-list-nav"><a href="S3Client.html#list">list</a></li><li data-type="method" id="S3Client-upload-nav"><a href="S3Client.html#upload">upload</a></li></ul></li><li id="S3Transfer-nav"><a href="S3Transfer.html">S3Transfer</a><ul class='methods'><li data-type="method" id="S3Transfer-getRemoteUrl-nav"><a href="S3Transfer.html#getRemoteUrl">getRemoteUrl</a></li></ul></li><li id="StorageService-nav"><a href="StorageService.html">StorageService</a><ul class='methods'><li data-type="method" id="StorageService-getValue-nav"><a href="StorageService.html#getValue">getValue</a></li><li data-type="method" id="StorageService-url-nav"><a href="StorageService.html#url">url</a></li><li data-type="method" id="StorageService-validate-nav"><a href="StorageService.html#validate">validate</a></li></ul></li><li id="TagDefinition-nav"><a href="TagDefinition.html">TagDefinition</a><ul class='methods'><li data-type="method" id="TagDefinition-fromCommandLineArg-nav"><a href="TagDefinition.html#.fromCommandLineArg">fromCommandLineArg</a></li><li data-type="method" id="TagDefinition-getValue-nav"><a href="TagDefinition.html#getValue">getValue</a></li><li data-type="method" id="TagDefinition-looksLikeDescriptionTag-nav"><a href="TagDefinition.html#looksLikeDescriptionTag">looksLikeDescriptionTag</a></li><li data-type="method" id="TagDefinition-systemMustSet-nav"><a href="TagDefinition.html#systemMustSet">systemMustSet</a></li><li data-type="method" id="TagDefinition-toFormattedString-nav"><a href="TagDefinition.html#toFormattedString">toFormattedString</a></li><li data-type="method" id="TagDefinition-validate-nav"><a href="TagDefinition.html#validate">validate</a></li><li data-type="method" id="TagDefinition-validateForJob-nav"><a href="TagDefinition.html#validateForJob">validateForJob</a></li></ul></li><li id="TagFileForm-nav"><a href="TagFileForm.html">TagFileForm</a></li><li id="TagFileParser-nav"><a href="TagFileParser.html">TagFileParser</a></li><li id="TarReader-nav"><a href="TarReader.html">TarReader</a><ul class='methods'><li data-type="method" id="TarReader-description-nav"><a href="TarReader.html#.description">description</a></li><li data-type="method" id="TarReader-list-nav"><a href="TarReader.html#list">list</a></li><li data-type="method" id="TarReader-read-nav"><a href="TarReader.html#read">read</a></li></ul></li><li id="TarWriter-nav"><a href="TarWriter.html">TarWriter</a><ul class='methods'><li data-type="method" id="TarWriter-description-nav"><a href="TarWriter.html#.description">description</a></li><li data-type="method" id="TarWriter-add-nav"><a href="TarWriter.html#add">add</a></li></ul></li><li id="TaskDescription-nav"><a href="TaskDescription.html">TaskDescription</a></li><li id="TestUtil-nav"><a href="TestUtil.html">TestUtil</a><ul class='methods'><li data-type="method" id="TestUtil-deleteJsonFile-nav"><a href="TestUtil.html#.deleteJsonFile">deleteJsonFile</a></li><li data-type="method" id="TestUtil-loadProfile-nav"><a href="TestUtil.html#.loadProfile">loadProfile</a></li></ul></li><li id="UploadOperation-nav"><a href="UploadOperation.html">UploadOperation</a><ul class='methods'><li data-type="method" id="UploadOperation-inflateFrom-nav"><a href="UploadOperation.html#.inflateFrom">inflateFrom</a></li><li data-type="method" id="UploadOperation-validate-nav"><a href="UploadOperation.html#validate">validate</a></li></ul></li><li id="UploadTestHelper-nav"><a href="UploadTestHelper.html">UploadTestHelper</a><ul class='methods'><li data-type="method" id="UploadTestHelper-envHasS3Credentials-nav"><a href="UploadTestHelper.html#envHasS3Credentials">envHasS3Credentials</a></li><li data-type="method" id="UploadTestHelper-getStorageService-nav"><a href="UploadTestHelper.html#getStorageService">getStorageService</a></li></ul></li><li id="Util-nav"><a href="Util.html">Util</a><ul class='methods'><li data-type="method" id="Util-bagNameFromPath-nav"><a href="Util.html#.bagNameFromPath">bagNameFromPath</a></li><li data-type="method" id="Util-boolEqual-nav"><a href="Util.html#.boolEqual">boolEqual</a></li><li data-type="method" id="Util-boolValue-nav"><a href="Util.html#.boolValue">boolValue</a></li><li data-type="method" id="Util-camelToTitle-nav"><a href="Util.html#.camelToTitle">camelToTitle</a></li><li data-type="method" id="Util-cast-nav"><a href="Util.html#.cast">cast</a></li><li data-type="method" id="Util-deleteFromArray-nav"><a href="Util.html#.deleteFromArray">deleteFromArray</a></li><li data-type="method" id="Util-deleteRecursive-nav"><a href="Util.html#.deleteRecursive">deleteRecursive</a></li><li data-type="method" id="Util-escapeBackslashes-nav"><a href="Util.html#.escapeBackslashes">escapeBackslashes</a></li><li data-type="method" id="Util-filterEmptyStrings-nav"><a href="Util.html#.filterEmptyStrings">filterEmptyStrings</a></li><li data-type="method" id="Util-getEnvSetting-nav"><a href="Util.html#.getEnvSetting">getEnvSetting</a></li><li data-type="method" id="Util-getSortFunction-nav"><a href="Util.html#.getSortFunction">getSortFunction</a></li><li data-type="method" id="Util-isEmpty-nav"><a href="Util.html#.isEmpty">isEmpty</a></li><li data-type="method" id="Util-isEmptyStringArray-nav"><a href="Util.html#.isEmptyStringArray">isEmptyStringArray</a></li><li data-type="method" id="Util-lcFirst-nav"><a href="Util.html#.lcFirst">lcFirst</a></li><li data-type="method" id="Util-listContains-nav"><a href="Util.html#.listContains">listContains</a></li><li data-type="method" id="Util-looksLikeEnvSetting-nav"><a href="Util.html#.looksLikeEnvSetting">looksLikeEnvSetting</a></li><li data-type="method" id="Util-looksLikeHypertextURL-nav"><a href="Util.html#.looksLikeHypertextURL">looksLikeHypertextURL</a></li><li data-type="method" id="Util-looksLikeUUID-nav"><a href="Util.html#.looksLikeUUID">looksLikeUUID</a></li><li data-type="method" id="Util-normalizeWindowsPath-nav"><a href="Util.html#.normalizeWindowsPath">normalizeWindowsPath</a></li><li data-type="method" id="Util-tmpFilePath-nav"><a href="Util.html#.tmpFilePath">tmpFilePath</a></li><li data-type="method" id="Util-toHumanSize-nav"><a href="Util.html#.toHumanSize">toHumanSize</a></li><li data-type="method" id="Util-truncateString-nav"><a href="Util.html#.truncateString">truncateString</a></li><li data-type="method" id="Util-unicodeByteLength-nav"><a href="Util.html#.unicodeByteLength">unicodeByteLength</a></li><li data-type="method" id="Util-uuid4-nav"><a href="Util.html#.uuid4">uuid4</a></li><li data-type="method" id="Util-walkSync-nav"><a href="Util.html#.walkSync">walkSync</a></li></ul></li><li id="ValidationOperation-nav"><a href="ValidationOperation.html">ValidationOperation</a><ul class='methods'><li data-type="method" id="ValidationOperation-inflateFrom-nav"><a href="ValidationOperation.html#.inflateFrom">inflateFrom</a></li><li data-type="method" id="ValidationOperation-validate-nav"><a href="ValidationOperation.html#validate">validate</a></li></ul></li><li id="Validator-nav"><a href="Validator.html">Validator</a><ul class='methods'><li data-type="method" id="Validator-_addBagItFile-nav"><a href="Validator.html#_addBagItFile">_addBagItFile</a></li><li data-type="method" id="Validator-_cleanEntryRelPath-nav"><a href="Validator.html#_cleanEntryRelPath">_cleanEntryRelPath</a></li><li data-type="method" id="Validator-_expectedTopLevelFiles-nav"><a href="Validator.html#_expectedTopLevelFiles">_expectedTopLevelFiles</a></li><li data-type="method" id="Validator-_getCryptoHashes-nav"><a href="Validator.html#_getCryptoHashes">_getCryptoHashes</a></li><li data-type="method" id="Validator-_readBag-nav"><a href="Validator.html#_readBag">_readBag</a></li><li data-type="method" id="Validator-_readEntry-nav"><a href="Validator.html#_readEntry">_readEntry</a></li><li data-type="method" id="Validator-_readFile-nav"><a href="Validator.html#_readFile">_readFile</a></li><li data-type="method" id="Validator-_scanBag-nav"><a href="Validator.html#_scanBag">_scanBag</a></li><li data-type="method" id="Validator-_validateFormatAndContents-nav"><a href="Validator.html#_validateFormatAndContents">_validateFormatAndContents</a></li><li data-type="method" id="Validator-_validateManifestEntries-nav"><a href="Validator.html#_validateManifestEntries">_validateManifestEntries</a></li><li data-type="method" id="Validator-_validateNoExtraneousPayloadFiles-nav"><a href="Validator.html#_validateNoExtraneousPayloadFiles">_validateNoExtraneousPayloadFiles</a></li><li data-type="method" id="Validator-_validatePayloadOxum-nav"><a href="Validator.html#_validatePayloadOxum">_validatePayloadOxum</a></li><li data-type="method" id="Validator-_validateProfile-nav"><a href="Validator.html#_validateProfile">_validateProfile</a></li><li data-type="method" id="Validator-_validateRequiredManifests-nav"><a href="Validator.html#_validateRequiredManifests">_validateRequiredManifests</a></li><li data-type="method" id="Validator-_validateSerialization-nav"><a href="Validator.html#_validateSerialization">_validateSerialization</a></li><li data-type="method" id="Validator-_validateSerializationFormat-nav"><a href="Validator.html#_validateSerializationFormat">_validateSerializationFormat</a></li><li data-type="method" id="Validator-_validateTags-nav"><a href="Validator.html#_validateTags">_validateTags</a></li><li data-type="method" id="Validator-_validateTopLevelDirs-nav"><a href="Validator.html#_validateTopLevelDirs">_validateTopLevelDirs</a></li><li data-type="method" id="Validator-_validateTopLevelFiles-nav"><a href="Validator.html#_validateTopLevelFiles">_validateTopLevelFiles</a></li><li data-type="method" id="Validator-_validateUntarDirectory-nav"><a href="Validator.html#_validateUntarDirectory">_validateUntarDirectory</a></li><li data-type="method" id="Validator-fileExtension-nav"><a href="Validator.html#fileExtension">fileExtension</a></li><li data-type="method" id="Validator-getNewReader-nav"><a href="Validator.html#getNewReader">getNewReader</a></li><li data-type="method" id="Validator-payloadFiles-nav"><a href="Validator.html#payloadFiles">payloadFiles</a></li><li data-type="method" id="Validator-payloadManifests-nav"><a href="Validator.html#payloadManifests">payloadManifests</a></li><li data-type="method" id="Validator-readingFromDir-nav"><a href="Validator.html#readingFromDir">readingFromDir</a></li><li data-type="method" id="Validator-readingFromTar-nav"><a href="Validator.html#readingFromTar">readingFromTar</a></li><li data-type="method" id="Validator-tagFiles-nav"><a href="Validator.html#tagFiles">tagFiles</a></li><li data-type="method" id="Validator-tagManifests-nav"><a href="Validator.html#tagManifests">tagManifests</a></li><li data-type="method" id="Validator-validate-nav"><a href="Validator.html#validate">validate</a></li></ul></li></ul><h3 id="global-nav">Global</h3><ul><li><a href="global.html#Config">Config</a></li><li><a href="global.html#Constants">Constants</a></li><li><a href="global.html#dataObject">dataObject</a></li><li><a href="global.html#FATAL_UPLOAD_ERRORS">FATAL_UPLOAD_ERRORS</a></li><li><a href="global.html#loadBuiltInProfiles">loadBuiltInProfiles</a></li><li><a href="global.html#ModifierFn">ModifierFn</a></li><li><a href="global.html#OPTS">OPTS</a></li><li><a href="global.html#pluginTypes">pluginTypes</a></li><li><a href="global.html#referenceObject">referenceObject</a></li><li><a href="global.html#run">run</a></li><li><a href="global.html#runAll">runAll</a></li><li><a href="global.html#tagsByLabel">tagsByLabel</a></li><li><a href="global.html#tagsSetBySystem">tagsSetBySystem</a></li><li><a href="global.html#titleTags">titleTags</a></li><li><a href="global.html#UIConstants">UIConstants</a></li></ul>
  </nav>

  <div id="main">
    
      <h1 class="page-title">
        bagit/bagit_profile.js
      </h1>
    

    
      

<section>
  <article>
    <pre class="prettyprint source linenums"><code>const { AppSetting } = require('../core/app_setting');
const { BagItProfileInfo } = require('./bagit_profile_info');
const { Constants } = require('../core/constants');
const { Context } = require('../core/context');
const fs = require('fs');
const { PersistentObject } = require('../core/persistent_object');
const { TagDefinition } = require('./tag_definition');
const { Util } = require('../core/util');

/**
 * BagItProfile describes what constitutes a valid bag.
 * These profiles are based on the BagIt profiles described
 * in https://github.com/bagit-profiles/bagit-profiles, with
 * some changes and additions.
 *
 * @see {@link https://github.com/bagit-profiles/bagit-profiles|Standard BagIt Profiles}
 * @see {@link BagItProfileInfo}
 * @see {@link TagDefinition}
 *
 * @param {object} opts - Object containing properties to set.
 *
 * @param {string} opts.id - A UUID in hex-string format. This is
 * the object's unique identifier.
 *
 * @param {boolean} opts.userCanDelete - Indicates whether user is
 * allowed to delete this record.
 *
 * @param {string} opts.name - The name this profile.
 * @default 'New BagIt Profile'
 * @param {string} opts.description - A helpful description of the profile
 * for people who will be using it.
 * @default 'New custom BagIt profile'
 */
class BagItProfile extends PersistentObject {

    constructor(opts = {}) {
        opts.required = ['name'];
        super(opts);
        /**
          * Name is the name of this profile.
          * Names should be unique, to prevent confusion.
          *
          * @type {string}
          */
        this.name = opts.name || 'New BagIt Profile';
        /**
          * The description of this profile should be meaningful to the user.
          *
          * @type {string}
          */
        this.description = opts.description || 'New custom BagIt profile';
        /**
          * A list of BagIt versions that are valid for bags that
          * conform to this profile. For example, '0.97'.
          *
          * @type {string[]}
          * @default ['0.97']
          */
        this.acceptBagItVersion = ['0.97', '1.0'];
        /**
          * A list of BagIt sserialization formats that are valid
          * for bags that conform to this profile. These may include
          * 'tar', 'zip', 'rar', etc.
          *
          * @type {string[]}
          * @default ['tar']
          */
        this.acceptSerialization = ['tar'];
        /**
          * This describes whether bags conforming to this profile
          * may have a fetch.txt file.
          *
          * @type {boolean}
          * @default false
          */
        this.allowFetchTxt = opts.allowFetchTxt === true ? true : false;
        /**
          * Describes whether bags conforming to this profile
          * may include files in the top-level folder other
          * than manifests, tag manifests, and the required tag
          * files listed in the {@link tags} list.
          *
          * @type {boolean}
          * @default false
          */
        this.allowMiscTopLevelFiles = opts.allowMiscTopLevelFiles === true ? true : false;
        /**
          * Describes whether bags conforming to this profile
          * may include directories other than the payload
          * directory (aka 'data' directory) in the top-level
          * folder. These other directories are sometimes used
          * to hold custom tag files.
          *
          * @type {boolean}
          * @default false
          */
        this.allowMiscDirectories = opts.allowMiscDirectories === true ? true : false;
        /**
          * This contains metadata about the BagIt profile
          * itself, such as who publishes and maintains it.
          *
          * @type {BagItProfileInfo}
          */
        this.bagItProfileInfo = opts.bagItProfileInfo || new BagItProfileInfo();
        /**
          * A list of algorithms of required manifests.
          * For example, 'sha256' indicates that bags conforming
          * to this profile must have a manifest-sha256.txt file.
          *
          * @type {string[]}
          * @default ['sha256']
          */
        this.manifestsRequired = opts.manifestsRequired || ['sha256'];
        /**
          * A list of algorithms of required tag manifests.
          * For example, 'sha256' indicates that bags conforming
          * to this profile must have a tagmanifest-sha256.txt file.
          * Leave this empty if no tag manifests are required.
          *
          * @type {string[]}
          * @default []
          */
        this.tagManifestsRequired = opts.tagManifestsRequired || [];
        /**
          * A list of tags that you expect to be present or expect
          * to parse when creating or validating bags that conform to
          * this profile.
          *
          * Note that this property was called requiredTags in prior
          * versions of DART, and in the BagItProfile JSON from those
          * versions.
          *
          * @type {TagDefinition[]}
          */
        this.tags = opts.tags || [];
        /**
          * Describes whether bags conforming to this profile may or
          * may not be serialized. Allowed values are 'required',
          * 'optional', and 'forbidden'.
          *
          * @type {string}
          * @default 'optional'
          */
        this.serialization = opts.serialization || "optional";
        /**
          * baseProfileId allows us to track whether this profile
          * is based on a built-in. If so, we don't allow the user
          * to modify certain elements of the profile. This will
          * be blank for many profiles.
          *
          * @type {string}
          * @default null
          */
        this.baseProfileId = opts.baseProfileId || null;
        /**
          * Describes whether this profile is built into the application.
          * Builtin profiles cannot be deleted by users.
          *
          * @type {boolean}
          * @default false
          */
        this.isBuiltIn = opts.isBuiltIn === true ? true : false;
        /**
          * Describes whether a tarred bag MUST untar to a directory
          * whose name matches the tar file name.
          *
          * E.g. Must bag "photos123.tar" untar to a directory called
          * "photos123". The APTrust and DPN specs, as well as some
          * others, require this, though the official BagIt spec does
          * not.
          *
          * @type {boolean}
          * @default false
          */
        this.tarDirMustMatchName = opts.tarDirMustMatchName === true ? true : false;
        /**
         * Contains information describing validation errors. Key is the
         * name of the invalid field. Value is a description of why the
         * field is not valid.
         *
         * @type {Object&lt;string, string>}
         */
        this.errors = {};

        this._addStandardBagItFile();
        this._addStandardBagInfoFile();
    }

    _addStandardBagItFile() {
        // BagIt spec says these two tags in bagit.txt file
        // are always required.
        if(this.getTagsFromFile('bagit.txt', 'Bagit-Version').length == 0) {
            var version = new TagDefinition({
                tagFile: 'bagit.txt',
                tagName: 'BagIt-Version'
            });
            version.required = true;
            version.emptyOk = false;
            version.values = Constants.BAGIT_VERSIONS;
            version.defaultValue = "0.97";
            version.help = "Which version of the BagIt specification describes this bag's format?";

        }
        if(this.getTagsFromFile('bagit.txt', 'Tag-File-Character-Encoding').length == 0) {
            var encoding = new TagDefinition({
                tagFile: 'bagit.txt',
                tagName: 'Tag-File-Character-Encoding'
            });
            encoding.required = true;
            encoding.emptyOk = false;
            encoding.defaultValue = "UTF-8";
            encoding.help = "How are this bag's plain-text tag files encoded? (Hint: usually UTF-8)";
            this.tags.push(version);
            this.tags.push(encoding);
        }
    }

    // This adds a standard bag-info.txt file to the BagIt profile.
    // We call this only when the user clicks to create a new blank profile.
    _addStandardBagInfoFile() {
        var tags = [
            'Bag-Count',
            'Bag-Group-Identifier',
            'Bag-Size',
            'Bagging-Date',
            'Bagging-Software',
            'Contact-Email',
            'Contact-Name',
            'Contact-Phone',
            'External-Description',
            'External-Identifier',
            'Internal-Sender-Description',
            'Internal-Sender-Identifier',
            'Organization-Address',
            'Payload-Oxum',
            'Source-Organization']
        for(var tagName of tags) {
            if(this.getTagsFromFile('bag-info.txt', tagName).length == 0) {
                var t = new TagDefinition({
                    tagFile: 'bag-info.txt',
                    tagName: tagName
                });
                t.required = false;
                t.emptyOk = true;
                this.tags.push(t);
            }
        }
    }

    /**
     * validate returns true or false, indicating whether this object
     * contains complete and valid data. If it returns false, check
     * the errors property for specific errors.
     *
     * @returns {boolean}
     */
    validate() {
        this.errors = {};
        super.validate();
        if (Util.isEmptyStringArray(this.acceptBagItVersion)) {
            this.errors["acceptBagItVersion"] = Context.y18n.__("Profile must accept at least one BagIt version.");
        }
        if (Util.isEmptyStringArray(this.manifestsRequired)) {
            this.errors["manifestsRequired"] = Context.y18n.__("Profile must require at least one manifest.");
        }
        if (!this.hasTagFile("bagit.txt")) {
            this.errors["tags"] = Context.y18n.__("Profile lacks requirements for bagit.txt tag file.");
        }
        if (!this.hasTagFile("bag-info.txt")) {
            this.errors["tags"] = this.errors["tags"] || '';
            this.errors["tags"] += Context.y18n.__("\nProfile lacks requirements for bag-info.txt tag file.");
        }
        if (!Util.listContains(Constants.REQUIREMENT_OPTIONS, this.serialization)) {
            this.errors["serialization"] = Context.y18n.__("Serialization must be one of: %s.", Constants.REQUIREMENT_OPTIONS.join(', '));
        }
        if ((this.serialization == 'required' || this.serialzation == 'optional') &amp;&amp;
            Util.isEmptyStringArray(this.acceptSerialization)) {
            this.errors["acceptSerialization"] = Context.y18n.__("When serialization is allowed, you must specify at least one serialization format.");
        }
        return Object.keys(this.errors).length == 0;
    }

    /**
     * findMatchingTags returns an array of TagDefinition objects
     * matching the specified criteria.
     *
     * @see also {@link findMatchingTag}
     *
     * @param {string} property - The name of the TagDefinition
     * property to match. For example, 'tagName' or 'defaultValue'.
     * @param {string} value - The value of the property to match.
     *
     * @returns {TagDefinition[]}
     */
    findMatchingTags(property, value) {
        return this.tags.filter(tag => tag[property] === value);
    }

    /**
     * findMatchingTag returns the first TagDefinition object that
     * matches the specified criteria.
     *
     * @see also {@link findMatchingTags}
     *
     * @param {string} property - The name of the TagDefinition
     * property to match. For example, 'tagName' or 'defaultValue'.
     * @param {string} value - The value of the property to match.
     *
     * @returns {TagDefinition}
     */
    firstMatchingTag(property, value) {
        return this.tags.find(tag => tag[property] === value);
    }

    /**
     * getTagsFromFile returns all tags with the specified tagname
     * from the specified file. This usually returns zero or one results,
     * but because the {@link https://tools.ietf.org/html/draft-kunze-bagit-14|BagIt spec}
     * says a tag can appear multiple times in a file, this may return a list.
     *
     * @see also {@link findMatchingTags}
     *
     * @param {string} filename - The name of the tagfile.
     * @param {string} tagname - The name of the tag.
     *
     * @returns {TagDefinition[]}
     */
    getTagsFromFile(filename, tagname) {
        return this.tags.filter(tag => tag.tagFile === filename &amp;&amp; tag.tagName === tagname);
    }

    /**
     * This returns true if the tags list includes a tagfile
     * with the specified filename.
     *
     * @param {string} filename - The name of the tagfile.
     *
     * @returns {boolean}
     */
    hasTagFile(filename) {
        return typeof this.tags.find(tag => tag.tagFile === filename) != 'undefined';
    }

    /**
     * This returns a suggested unique bag name that is valid for
     * the current profile.
     *
     * TODO: This belongs in a profile or in a vendor-specific module.
     *
     * @returns {string}
     */
    suggestBagName() {
        var suggestion = "";
        if (this.hasTagFile("aptrust-info.txt")) {
            var setting = AppSetting.firstMatching("name", "Institution Domain")
            suggestion = `${setting.value}.bag-${Date.now()}`
        } else if (this.hasTagFile("dpn-tags/dpn-info.txt")) {
            suggestion = Util.uuid4();
        } else {
            suggestion = BagItProfile.suggestGenericBagName();
        }
        return suggestion;
    }

    /**
     * This returns a generic unique bag name suggestion.
     *
     * @returns {string}
     */
    static suggestGenericBagName() {
        return `bag-${Date.now()}`;
    }

    /**
     * This returns true if the bag name contains no illegal
     * characters. Illegal characters include &lt;, >, :, ", /, \, ?, *,
     * space, tab, carriage return and newline.
     *
     * @param {string} name - The bag name you want to validate.
     *
     * @returns {boolean}
     */
    static nameLooksLegal(name) {
        var illegal = /[&lt;>:"\/\|\?\*\\\s\t\n\r]/g;
        return !Util.isEmpty(name) &amp;&amp; name.match(illegal) == null;
    }

    /**
     * This returns true if the name is legal for this profile.
     *
     * @param {string} name - The bag name you want to validate.
     *
     * @returns {boolean}
     */
    isValidBagName(name) {
        if (Util.isEmpty(name)) {
            return false;
        }
        if (this.hasTagFile("aptrust-info.txt")) {
            var setting = AppSetting.firstMatching("name", "Institution Domain")
            var requiredPrefix = `${setting.value}.`;
            return (name.startsWith(requiredPrefix) &amp;&amp;
                    name.length > requiredPrefix.length &amp;&amp;
                    BagItProfile.nameLooksLegal(name));
        } else if (this.hasTagFile("dpn-tags/dpn-info.txt")) {
            return Util.looksLikeUUID(name);
        } else {
            return BagItProfile.nameLooksLegal(name)
        }
    }

    /**
      * Returns a hash of required tags, with filename
      * as the key. Value is a list of required tags,
      * in alpha order by name.
      *
      * @returns {Object&lt;string, TagDefinition[]>}
      */
    tagsGroupedByFile() {
        var tagsByFile = {};
        for (var tag of this.tags) {
            if(tagsByFile[tag.tagFile] == null) {
                tagsByFile[tag.tagFile] = [];
            }
            tagsByFile[tag.tagFile].push(tag);
        }
        for (var f of Object.keys(tagsByFile)) {
            let sortFunction = Util.getSortFunction('tagName', 'asc');
            tagsByFile[f].sort(sortFunction);
        }
        return tagsByFile;
    }

    /**
      * getTagFileContents returns a string that you can
      * write to the tag file when creating a bag. Use requiredTagFileNames
      * to get all tag file names.
      *
      * @example
      * var contents = profile.getTagFileContentsByName(filename)
      * // returns
      * // Tag-Name: Value
      * // Other-Tag: Other value
      *
      * @param {string} name - The name of the tag file (relative path
      * within the bag)
      *
      * @returns {string}
      */
    getTagFileContents(tagFile) {
        var tags = this.tagsGroupedByFile(false)[tagFile];
        if (tags === undefined || !tags) {
            throw `No such tag file: ${tagFile}`;
        }
        var lines = [];
        for(var tagDef of tags) {
            lines.push(tagDef.toFormattedString());
        }
        return lines.join("\n") + "\n";
    }

    /**
      * Returns true if filename is a custom file added for a
      * specific job (i.e. is not part of the core profile).
      * All tags in a custom tag file have isUserAddedTag = true.
      *
      * @param {string} filename - The name of the tag file to check.
      *
      * @returns {boolean}
      */
    isCustomTagFile(filename) {
        for (var tag of this.tags) {
            if (tag.tagFile == filename &amp;&amp; tag.isUserAddedFile == true) {
                return true;
            }
        }
        return false;
    }

    /**
      * Returns the names of all tag files, in alpha order.
      *
      * @returns {string[]}
      */
    tagFileNames() {
        var fileNames = new Set();
        for (var tag of this.tags) {
            if (!fileNames.has(tag.tagFile)) {
                fileNames.add(tag.tagFile);
            }
        }
        return Array.from(fileNames).sort();
    }

    /**
      * Returns true if this profile says the bag must be tarred.
      *
      * @returns {boolean}
      */
    mustBeTarred() {
        return (this.acceptSerialization &amp;&amp;
                this.acceptSerialization.length == 1 &amp;&amp;
                this.acceptSerialization[0] == "application/tar" &amp;&amp;
                this.serialization == "required");
    }

    /**
      * This converts the stored representation, which is basically
      * a JSON hash, to a full-fledged BagItProfile object.
      *
      * See also {@link BagItProfile.load}
      *
      * @param {string} jsonString - String of JSON to covert to BagItProfile.
      *
      * @throws {SyntaxError} - Throws SyntaxError if jsonString cannot be parsed.
      *
      * @returns {BagItProfile}
      */
    static fromJson(jsonString) {
        var profile = null;
        var obj = JSON.parse(jsonString);
        if (obj != null) {
            profile = new BagItProfile();
            Object.assign(profile, obj);
            obj.tags.forEach(function(item, index, array) {
                // Convert the JSON data to a full TagDefinition object.
                var tagDef = new TagDefinition();
                Object.assign(tagDef, item);
                profile.tags[index] = tagDef;
            });
        }
        return profile;
    }

    /**
     * This loads a BagItProfile from a JSON file and returns
     * the BagItProfile object. After you've loaded the profile,
     * you can call the validate() method to make sure it's valid.
     *
     * This is a synchronous operation, and will throw errors if
     * file does not exist, is not readable, JSON is invalid, etc.
     *
     * See also {@link BagItProfile.fromJson}
     *
     * @param {string} pathToJsonFile - The path to the JSON file that
     * contains the profile you want to load.
     *
     * @returns {BagItProfile}
     */
    static load(pathToJsonFile) {
        let json = fs.readFileSync(pathToJsonFile);
        return BagItProfile.fromJson(json);
    }

    /**
      * Returns the best guess at bag title by checking
      * tags called 'Title' or that include 'Title' in the
      * tag files.
      *
      * @returns {string}
      */
    bagTitle() {
        return this.findExactOrPartial("title", "title");
    }

    /**
      * Returns the best guess at bag description by checking
      * tags called 'Internal-Sender-Description' and 'Description'
      * in the tag files.
      *
      * @returns {string}
      */
    bagDescription() {
        return this.findExactOrPartial("internal-sender-description", "description");
    }

    /**
      * Returns the value of the first tag whose name matches exactTagName,
      * or if there are none, the value of the the first tag whose name
      * contains partialTagName. Names are case insensitive.
      *
      * @returns {string}
      */
    findExactOrPartial(exactTagName, partialTagName) {
        var exactMatch = "";
        var partialMatch = "";
        var lcExactTagName = exactTagName.toLowerCase();
        var lcPartialTagName = partialTagName.toLowerCase();
        for(var tag of this.tags) {
            var tagName = tag.tagName.toLowerCase();
            if (tagName === lcExactTagName) {
                exactMatch = tag.getValue();
            } else if (tagName.includes(lcPartialTagName)) {
                partialMatch = tag.getValue();
            }
        }
        return exactMatch || partialMatch;
    }

    /**
      * Returns the bag's Internal-Sender-Identifier as specified
      * in the tag files, or an empty string if there is none.
      * It's common for this tag to appear in a tag file with no
      * value, which also leads to an empty string return value.
      *
      * Also note that this returns the value of the first
      * Internal-Sender-Identfier tag in the bag-info.txt file.
      *
      * @returns {string}
      */
    bagInternalIdentifier() {
        let tags = this.getTagsFromFile('bag-info.txt', 'Internal-Sender-Identifier');
        return tags.length > 0 ? tags[0].userValue : '';
    }

    /**
      * Copy default tag values from other profile to this profile.
      *
      * If multiple tags with the same name appear in the same
      * tag file, this copies only the first value. While the BagIt
      * spec permits multiple instances of a tag within a file, we're
      * assuming (naively?) that a BagItProfile will specify only one
      * default value for a tag in a given file.
      *
      * This method is generally used for cloning BagItProfiles.
      * If you want to copy userValues, for instance, when you're
      * creating a bag, see {@link mergeTagValues}.
      *
      * @param {BagItProfile} otherProfile - The BagItProfile whose
      * TagDefinition default values you want to copy.
      *
      */
    copyDefaultTagValuesFrom(otherProfile) {
        var changed = false;
        for(var t of otherProfile.tags) {
            var tags = this.getTagsFromFile(t.tagFile, t.tagName);
            if (tags[0] &amp;&amp; t.tagFile == tags[0].tagFile &amp;&amp; !Util.isEmpty(t.defaultValue)) {
                tags[0].defaultValue = t.defaultValue;
            }
        }
    }

    /**
      * Copy values into the userValue field of this profile's tags.
      * Use this when you're creating a bag and you want to write actual
      * values into the bag's tag files (as opposed to when you are
      * creating a reusable BagItProfile).
      *
      * If multiple tags with the same name appear in the same
      * tag file, this copies only the first value. If a tag in the
      * tags param does not exist in the profile, it will be added
      * for one-time use. (That is, it will be added to the profile for
      * the scope of one bagging or validation operation, but will
      * not be saved as part of the reusable BagItProfile.)
      *
      * If you want to copy default values when cloning an existing
      * BagItProfile, see {@link copyDefaultValuesFrom}.
      *
      * @param {Array&lt;TagDefinition>} tags - An array of tags whose
      * userValues you want to copy into this profile.
      *
      */
    mergeTagValues(tags) {
        for(var t of tags) {
            var existingTags = this.getTagsFromFile(t.tagFile, t.tagName);
            if (existingTags[0] &amp;&amp; t.tagFile == existingTags[0].tagFile) {
                existingTags[0].userValue = t.userValue;
            } else if (!existingTags[0]) {
                this.tags.push(t);
            }
        }
    }

    /**
     * This creates a new BagItProfile or a vanilla data object that
     * contains the attributes of a BagItProfile. This is used by the
     * find() method to inflate a JSON hash retrieved from the DB into
     * a full-fledged BagItProfile object, and by the BagItProfileController
     * when creating a new BagItProfile based on an existing BagItProfile.
     *
     * If you intend to clone an existing profile to create a new one, be
     * sure to change the profile's id after cloning it. Otherwise, when you
     * save the new (cloned) profile, it will overwrite the old one in the DB.
     *
     * @param {BagItProfile|object} otherProfile - The BagItProfile you want
     * to copy, or a vanilla object that contains the same properties as a
     * BagItProfile (such as BagItProfile JSON record retrieved from the
     * DART database).
     *
     * @returns {BagItProfile}
     */
    static inflateFrom(otherProfile) {
        let profile = new BagItProfile();
        Object.assign(profile, otherProfile);
        profile.bagItProfileInfo = new BagItProfileInfo();
        Object.assign(profile.bagItProfileInfo, otherProfile.bagItProfileInfo);
        for (let i=0; i &lt; otherProfile.tags.length; i++) {
            let tagDef = new TagDefinition();
            Object.assign(tagDef, otherProfile.tags[i]);
            profile.tags[i] = tagDef;
        }
        return profile;
    }


    /* ------- Implementation of PersistentObject methods -------- */

    /**
     * find finds the BagItProfile with the specified id in the datastore
     * and returns it. Returns undefined if the object is not in the datastore.
     *
     * This overrides the find() method of PersistentObject to return a
     * correctly constructed BagItProfile object.
     *
     * @param {string} id - The id (UUID) of the BagItProfile you want to find.
     *
     * @returns {BagItProfile}
     */
    static find(id) {
        let data = Context.db('BagItProfile').get(id);
        if (data) {
            return BagItProfile.inflateFrom(data);
        }
        return undefined;
    }
}

// Copy static finder methods from PersistentObject
Object.assign(BagItProfile, PersistentObject);

module.exports.BagItProfile = BagItProfile;
</code></pre>
  </article>
</section>

    


  </div>

  <br class="clear">

  <footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.2</a>
  </footer>

  <script src="scripts/linenumber.js"></script>
  <script src="scripts/pagelocation.js"></script>

  

</body>
</html>
