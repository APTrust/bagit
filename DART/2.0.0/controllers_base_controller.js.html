

<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
      controllers/base_controller.js - Documentation
  </title>

  <link href="https://www.braintreepayments.com/images/favicon-ccda0b14.png" rel="icon" type="image/png">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

  <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
  <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
  
  <link type="text/css" rel="stylesheet" href="styles/collapse.css">
  

  

  <!-- start Mixpanel -->
  <script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("1919205b2da72e4da3b9b6639b444d59");</script>
  <!-- end Mixpanel -->
</head>

<body>
  <svg style="display: none;">
    <defs>
      <symbol id="linkIcon" fill="#706d77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
          <path d="M0 0h24v24H0z" fill="none"/>
          <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>
      </symbol>
    </defs>
  </svg>

  <input type="checkbox" id="nav-trigger" class="nav-trigger" />
  <label for="nav-trigger" class="navicon-button x">
    <div class="navicon"></div>
  </label>

  <label for="nav-trigger" class="overlay"></label>

  <div class="top-nav-wrapper">
    <ul>
      <li >
        <a href="index.html">
          
            <svg fill="#6D6D6D" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
              <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
              <path d="M0 0h24v24H0z" fill="none"/>
            </svg>
          
          
        </a>
      </li>

      

    </ul>
  </div>

  <nav>
    <h3 class="reference-title">
      DART (Digital Asset Routing Tool)
    </h3>

    
      <h3>
        Resources
      </h3>
      
    

    <h3>Classes</h3><ul><li id="BaseController-nav"><a href="BaseController.html">BaseController</a><ul class='methods'><li data-type="method" id="BaseController-containerContent-nav"><a href="BaseController.html#containerContent">containerContent</a></li><li data-type="method" id="BaseController-destroy-nav"><a href="BaseController.html#destroy">destroy</a></li><li data-type="method" id="BaseController-edit-nav"><a href="BaseController.html#edit">edit</a></li><li data-type="method" id="BaseController-list-nav"><a href="BaseController.html#list">list</a></li><li data-type="method" id="BaseController-modalContent-nav"><a href="BaseController.html#modalContent">modalContent</a></li><li data-type="method" id="BaseController-new-nav"><a href="BaseController.html#new">new</a></li><li data-type="method" id="BaseController-noContent-nav"><a href="BaseController.html#noContent">noContent</a></li><li data-type="method" id="BaseController-openExternal-nav"><a href="BaseController.html#openExternal">openExternal</a></li><li data-type="method" id="BaseController-paramsToHash-nav"><a href="BaseController.html#paramsToHash">paramsToHash</a></li><li data-type="method" id="BaseController-postRenderCallback-nav"><a href="BaseController.html#postRenderCallback">postRenderCallback</a></li><li data-type="method" id="BaseController-redirect-nav"><a href="BaseController.html#redirect">redirect</a></li><li data-type="method" id="BaseController-update-nav"><a href="BaseController.html#update">update</a></li></ul></li><li id="Choice-nav"><a href="Choice.html">Choice</a><ul class='methods'><li data-type="method" id="Choice-makeList-nav"><a href="Choice.html#.makeList">makeList</a></li></ul></li><li id="DartProcessController-nav"><a href="DartProcessController.html">DartProcessController</a><ul class='methods'><li data-type="method" id="DartProcessController-list-nav"><a href="DartProcessController.html#list">list</a></li></ul></li><li id="DashboardController-nav"><a href="DashboardController.html">DashboardController</a><ul class='methods'><li data-type="method" id="DashboardController-_getJobOutcomeAndTimestamp-nav"><a href="DashboardController.html#_getJobOutcomeAndTimestamp">_getJobOutcomeAndTimestamp</a></li><li data-type="method" id="DashboardController-_getRecentJobSummaries-nav"><a href="DashboardController.html#_getRecentJobSummaries">_getRecentJobSummaries</a></li><li data-type="method" id="DashboardController-_getRepoReportDescriptions-nav"><a href="DashboardController.html#_getRepoReportDescriptions">_getRepoReportDescriptions</a></li><li data-type="method" id="DashboardController-_getRepoRows-nav"><a href="DashboardController.html#_getRepoRows">_getRepoRows</a></li><li data-type="method" id="DashboardController-_getViableRepoClients-nav"><a href="DashboardController.html#_getViableRepoClients">_getViableRepoClients</a></li><li data-type="method" id="DashboardController-show-nav"><a href="DashboardController.html#show">show</a></li></ul></li><li id="Form-nav"><a href="Form.html">Form</a><ul class='methods'><li data-type="method" id="Form-_initField-nav"><a href="Form.html#_initField">_initField</a></li><li data-type="method" id="Form-_initFields-nav"><a href="Form.html#_initFields">_initFields</a></li><li data-type="method" id="Form-castNewValueToType-nav"><a href="Form.html#castNewValueToType">castNewValueToType</a></li><li data-type="method" id="Form-hasErrors-nav"><a href="Form.html#hasErrors">hasErrors</a></li><li data-type="method" id="Form-parseFromDOM-nav"><a href="Form.html#parseFromDOM">parseFromDOM</a></li><li data-type="method" id="Form-setErrors-nav"><a href="Form.html#setErrors">setErrors</a></li></ul></li><li id="JobController-nav"><a href="JobController.html">JobController</a><ul class='methods'><li data-type="method" id="JobController-colorCodeJobs-nav"><a href="JobController.html#colorCodeJobs">colorCodeJobs</a></li><li data-type="method" id="JobController-list-nav"><a href="JobController.html#list">list</a></li><li data-type="method" id="JobController-new-nav"><a href="JobController.html#new">new</a></li></ul></li><li id="JobFilesController-nav"><a href="JobFilesController.html">JobFilesController</a><ul class='methods'><li data-type="method" id="JobFilesController-addFileToPackageSources-nav"><a href="JobFilesController.html#addFileToPackageSources">addFileToPackageSources</a></li><li data-type="method" id="JobFilesController-addItemsToUI-nav"><a href="JobFilesController.html#addItemsToUI">addItemsToUI</a></li><li data-type="method" id="JobFilesController-addItemToUI-nav"><a href="JobFilesController.html#addItemToUI">addItemToUI</a></li><li data-type="method" id="JobFilesController-addRow-nav"><a href="JobFilesController.html#addRow">addRow</a></li><li data-type="method" id="JobFilesController-attachDeleteEvents-nav"><a href="JobFilesController.html#attachDeleteEvents">attachDeleteEvents</a></li><li data-type="method" id="JobFilesController-attachDragAndDropEvents-nav"><a href="JobFilesController.html#attachDragAndDropEvents">attachDragAndDropEvents</a></li><li data-type="method" id="JobFilesController-findContainingItem-nav"><a href="JobFilesController.html#findContainingItem">findContainingItem</a></li><li data-type="method" id="JobFilesController-getTableRow-nav"><a href="JobFilesController.html#getTableRow">getTableRow</a></li><li data-type="method" id="JobFilesController-postRenderCallback-nav"><a href="JobFilesController.html#postRenderCallback">postRenderCallback</a></li><li data-type="method" id="JobFilesController-removeItemFromUI-nav"><a href="JobFilesController.html#removeItemFromUI">removeItemFromUI</a></li><li data-type="method" id="JobFilesController-show-nav"><a href="JobFilesController.html#show">show</a></li><li data-type="method" id="JobFilesController-updateTotal-nav"><a href="JobFilesController.html#updateTotal">updateTotal</a></li><li data-type="method" id="JobFilesController-updateTotals-nav"><a href="JobFilesController.html#updateTotals">updateTotals</a></li></ul></li><li id="JobMetadataController-nav"><a href="JobMetadataController.html">JobMetadataController</a><ul class='methods'><li data-type="method" id="JobMetadataController-_attachTagFileAutocomplete-nav"><a href="JobMetadataController.html#_attachTagFileAutocomplete">_attachTagFileAutocomplete</a></li><li data-type="method" id="JobMetadataController-_attachToggleHiddenTags-nav"><a href="JobMetadataController.html#_attachToggleHiddenTags">_attachToggleHiddenTags</a></li><li data-type="method" id="JobMetadataController-_parseMetadataForm-nav"><a href="JobMetadataController.html#_parseMetadataForm">_parseMetadataForm</a></li><li data-type="method" id="JobMetadataController-_validateMetadataForm-nav"><a href="JobMetadataController.html#_validateMetadataForm">_validateMetadataForm</a></li><li data-type="method" id="JobMetadataController-back-nav"><a href="JobMetadataController.html#back">back</a></li><li data-type="method" id="JobMetadataController-newTag-nav"><a href="JobMetadataController.html#newTag">newTag</a></li><li data-type="method" id="JobMetadataController-next-nav"><a href="JobMetadataController.html#next">next</a></li><li data-type="method" id="JobMetadataController-postRenderCallback-nav"><a href="JobMetadataController.html#postRenderCallback">postRenderCallback</a></li><li data-type="method" id="JobMetadataController-saveNewTag-nav"><a href="JobMetadataController.html#saveNewTag">saveNewTag</a></li><li data-type="method" id="JobMetadataController-show-nav"><a href="JobMetadataController.html#show">show</a></li></ul></li><li id="JobPackageOp-nav"><a href="JobPackageOp.html">JobPackageOp</a></li><li id="JobPackageOpForm-nav"><a href="JobPackageOpForm.html">JobPackageOpForm</a></li><li id="JobPackagingController-nav"><a href="JobPackagingController.html">JobPackagingController</a><ul class='methods'><li data-type="method" id="JobPackagingController-_parseJobPackagingForm-nav"><a href="JobPackagingController.html#_parseJobPackagingForm">_parseJobPackagingForm</a></li><li data-type="method" id="JobPackagingController-_renderPackagingForm-nav"><a href="JobPackagingController.html#_renderPackagingForm">_renderPackagingForm</a></li><li data-type="method" id="JobPackagingController-_updatePackaging-nav"><a href="JobPackagingController.html#_updatePackaging">_updatePackaging</a></li><li data-type="method" id="JobPackagingController-back-nav"><a href="JobPackagingController.html#back">back</a></li><li data-type="method" id="JobPackagingController-next-nav"><a href="JobPackagingController.html#next">next</a></li><li data-type="method" id="JobPackagingController-onFormatChange-nav"><a href="JobPackagingController.html#onFormatChange">onFormatChange</a></li><li data-type="method" id="JobPackagingController-onPackageNameKeyUp-nav"><a href="JobPackagingController.html#onPackageNameKeyUp">onPackageNameKeyUp</a></li><li data-type="method" id="JobPackagingController-postRenderCallback-nav"><a href="JobPackagingController.html#postRenderCallback">postRenderCallback</a></li><li data-type="method" id="JobPackagingController-show-nav"><a href="JobPackagingController.html#show">show</a></li></ul></li><li id="JobRunController-nav"><a href="JobRunController.html">JobRunController</a><ul class='methods'><li data-type="method" id="JobRunController-back-nav"><a href="JobRunController.html#back">back</a></li><li data-type="method" id="JobRunController-run-nav"><a href="JobRunController.html#run">run</a></li><li data-type="method" id="JobRunController-show-nav"><a href="JobRunController.html#show">show</a></li></ul></li><li id="JobTagsForm-nav"><a href="JobTagsForm.html">JobTagsForm</a><ul class='methods'><li data-type="method" id="JobTagsForm-_tagDefToField-nav"><a href="JobTagsForm.html#_tagDefToField">_tagDefToField</a></li></ul></li><li id="JobUploadController-nav"><a href="JobUploadController.html">JobUploadController</a><ul class='methods'><li data-type="method" id="JobUploadController-back-nav"><a href="JobUploadController.html#back">back</a></li><li data-type="method" id="JobUploadController-next-nav"><a href="JobUploadController.html#next">next</a></li><li data-type="method" id="JobUploadController-show-nav"><a href="JobUploadController.html#show">show</a></li></ul></li><li id="JobUploadForm-nav"><a href="JobUploadForm.html">JobUploadForm</a></li><li id="RunningJobsController-nav"><a href="RunningJobsController.html">RunningJobsController</a></li><li id="SetupController-nav"><a href="SetupController.html">SetupController</a><ul class='methods'><li data-type="method" id="SetupController-_formatLastRunDate-nav"><a href="SetupController.html#_formatLastRunDate">_formatLastRunDate</a></li><li data-type="method" id="SetupController-_getLastRunDate-nav"><a href="SetupController.html#_getLastRunDate">_getLastRunDate</a></li><li data-type="method" id="SetupController-end-nav"><a href="SetupController.html#end">end</a></li><li data-type="method" id="SetupController-getLogoPath-nav"><a href="SetupController.html#getLogoPath">getLogoPath</a></li><li data-type="method" id="SetupController-list-nav"><a href="SetupController.html#list">list</a></li><li data-type="method" id="SetupController-postRenderCallback-nav"><a href="SetupController.html#postRenderCallback">postRenderCallback</a></li><li data-type="method" id="SetupController-question-nav"><a href="SetupController.html#question">question</a></li><li data-type="method" id="SetupController-runPreQuestionCallbacks-nav"><a href="SetupController.html#runPreQuestionCallbacks">runPreQuestionCallbacks</a></li><li data-type="method" id="SetupController-start-nav"><a href="SetupController.html#start">start</a></li><li data-type="method" id="SetupController-startQuestions-nav"><a href="SetupController.html#startQuestions">startQuestions</a></li></ul></li><li id="SetupQuestion-nav"><a href="SetupQuestion.html">SetupQuestion</a><ul class='methods'><li data-type="method" id="SetupQuestion-getIntRangeValidator-nav"><a href="SetupQuestion.html#.getIntRangeValidator">getIntRangeValidator</a></li><li data-type="method" id="SetupQuestion-getPatternValidator-nav"><a href="SetupQuestion.html#.getPatternValidator">getPatternValidator</a></li><li data-type="method" id="SetupQuestion-getRequiredValidator-nav"><a href="SetupQuestion.html#.getRequiredValidator">getRequiredValidator</a></li><li data-type="method" id="SetupQuestion-_setValidationRegExp-nav"><a href="SetupQuestion.html#_setValidationRegExp">_setValidationRegExp</a></li><li data-type="method" id="SetupQuestion-getValidators-nav"><a href="SetupQuestion.html#getValidators">getValidators</a></li><li data-type="method" id="SetupQuestion-looksLikeNumericValidation-nav"><a href="SetupQuestion.html#looksLikeNumericValidation">looksLikeNumericValidation</a></li><li data-type="method" id="SetupQuestion-processResponse-nav"><a href="SetupQuestion.html#processResponse">processResponse</a></li><li data-type="method" id="SetupQuestion-readUserInput-nav"><a href="SetupQuestion.html#readUserInput">readUserInput</a></li><li data-type="method" id="SetupQuestion-saveValue-nav"><a href="SetupQuestion.html#saveValue">saveValue</a></li><li data-type="method" id="SetupQuestion-setInitialValue-nav"><a href="SetupQuestion.html#setInitialValue">setInitialValue</a></li><li data-type="method" id="SetupQuestion-validate-nav"><a href="SetupQuestion.html#validate">validate</a></li></ul></li><li id="TagFileForm-nav"><a href="TagFileForm.html">TagFileForm</a></li><li id="WorkflowForm-nav"><a href="WorkflowForm.html">WorkflowForm</a></li></ul><h3 id="global-nav">Global</h3><ul><li><a href="global.html#tagsByFileAndName">tagsByFileAndName</a></li><li><a href="global.html#UIConstants">UIConstants</a></li></ul>
  </nav>

  <div id="main">
    
      <h1 class="page-title">
        controllers/base_controller.js
      </h1>
    

    
      

<section>
  <article>
    <pre class="prettyprint source linenums"><code>const { Context } = require('../../core/context')
const electron = require('electron');
const Templates = require('../common/templates');
const { Util } = require('../../core/util');
const { Workflow } = require('../../core/workflow');

/**
 * BaseController is the base class from which other view controllers
 * derive. This class implements the basic controller actions such as
 * displaying forms and lists, saving user-edited objects, etc.
 *
 * The BaseController and all its subclasses use standard HTTP query
 * params to pass parameters. They also use DART Forms, which parse
 * HTML form data using jQuery.
 *
 * @param {url.URLSearchParams} params - URL parameters from the UI.
 * These usually come from a query string attached to the href attribute
 * of a link or button.
 *
 * @param {string} navSection - The section of DART's top navigation bar
 * that should be highlighted when this controller renders a page. For
 * example, when rendering {@link AppSetting} pages, the "Settings"
 * section of the top nav bar should be active.
 */
class BaseController {

    constructor(params, navSection) {
        /**
         * A {@link url.URLSearchParams} object containing parameters that
         * the controller will need to render the display. For forms, the
         * only required param is usually "id", which is the UUID of the
         * object to be edited. For lists, this typically includes
         * limit, offset, orderBy, and sortDirection.
         *
         * @type {url.URLSearchParams}
         */
        this.params = params;
        /**
         * The typeMap describes how values in this.params should be converted,
         * if they do need to be converted. Because {@link url.URLSearchParams}
         * are always either strings or arrays of strings, we sometimes need
         * to convert them to numbers or booleans before we can use them.
         * For example, a controller that lists a number of objects needs the
         * "limit" param to be converted from string "20" to number 20.
         *
         * typeMap key is the param name and value is the data type.
         *
         * The typeMap currently supports types "string", "boolean", and
         * "number" (no dates yet). Each controller sets its own typeMap
         * as necessary.
         *
         * @type {object.&lt;string, string>}
         */
        this.typeMap = {};
        /**
         * The name of the nav section to highlight when this controller
         * renders a page. Valid values include any names you see on DART's
         * top nav bar, including "Dashboard", "Settings", "Jobs" and "Help".
         *
         * @type {string}
         */
        this.navSection = navSection;
        /**
         * Controllers may optionally set this before redirecting,
         * to make an alert message appear on the top of the destination
         * page. For example, after successfully submitting a form, a
         * controller typically redirects to the list page with an alert
         * message at the top saying the data  was saved.
         *
         * @type {string}
         */
        this.alertMessage = null;

        /**
         * Controllers may optionally set this before redirecting to control
         * the appearance of the optional alertMessage. The value can be any
         * valid Bootstrap 4 alert class. The most common values will be
         * "alert-success" and "alert-danger".
         *
         * @type {string}
         * @default "alert-success"
         */
        this.alertCssClass = 'alert-success';

        // The following are all set by child classes.
        /**
         * This is the model which the controller represents. For example,
         * The AppSettingController renders forms and lists for the AppSetting
         * model. This must be set by the child class.
         *
         * @type {PersistentObject|object}
         */
        this.model;
        /**
         * This is the name of the form class that can render a form for
         * this controller's model. For example, the AppSettingController
         * will have formClass AppSettingForm. This must be set by the child
         * class.
         *
         * @type {Form}
         */
        this.formClass;
        /**
         * This is the template that renders this controller's form.
         * Templates are properties of the {@link Template} object.
         * This property must be set by the child class.
         *
         * @type {handlebars.Template}
         */
        this.formTemplate;
        /**
         * This is the template that renders this controller's object list.
         * Templates are properties of the {@link Template} object.
         * This property must be set by the child class.
         *
         * @type {handlebars.Template}
         */
        this.listTemplate;
        /**
         * The name property of this template's model. This is used when
         * ordering lists of objects by name. For example, the nameProperty
         * for model {@link BagItProfile} or {@link AppSetting} would be
         * "name".
         *
         * @type {string}
         */
        this.nameProperty;
        /**
         * This property will be set to true if the controller that was
         * originally called redirected to a new controller.
         *
         * @type {boolean}
         * @default false
         */
        this.redirected = false;
    }

    /**
     * Converts URLSearchParams to a simple hash with correct data types.
     * The data types are specified in each controller's typeMap, which
     * can specify that certain params be converted to numbers or booleans.
     *
     */
    paramsToHash() {
        let data = {};
        for(let [key, value] of this.params.entries()) {
            let toType = this.typeMap[key] || 'string';
            if (toType === 'string') {
                data[key] = value;
            } else {
                data[key] = Util.cast(value, toType);
            }
        }
        return data;
    }

    /**
     * The sets the content of the main page container to the html
     * you pass in.
     *
     * @param {string} html - HTML content to render in the page's
     * main container.
     */
    containerContent(html) {
        let workflows = Workflow.list(null, {
            orderBy: 'name',
            sortDirection: 'asc'
        });
        return {
            nav: Templates.nav({
                section: this.navSection,
                workflows: workflows
            }),
            container: html
        }
    }

    /**
     * This sets the title and body of the modal popup window.
     *
     * @param {string} title - The title of the modal popup.
     *
     * @param {string} body - The HTML content of the modal popup.
     */
    modalContent(title, body) {
        return {
            modalTitle: title,
            modalContent: body
        }
    }

    /**
     * Controller methods call this when they do not want to render
     * any new content.
     */
    noContent() {
        return {};
    }

    /**
     * This opens a URL in an external browser window, using the user's
     * default web browser.
     *
     * The URL comes the value of the "url" param in the params object
     * that was passed in to this object's constructor. Derived classes
     * can also call this.params.set('url', '...value...') before calling
     * this method.
     */
    openExternal() {
        electron.shell.openExternal(this.params.get('url'));
    }

    /**
     * This redirects to a new URL that will call the function fnName
     * on the controller controllerName with the specified params.
     * Use this only when redirecting to an entirely new controller.
     *
     * This changes the page URL, causing the {@link RequestHandler}
     * to parse and route the new request.
     *
     * @example
     * this.redirect('JobFiles', 'show', this.params);
     *
     * @param {string} controllerName - The name of the controller you
     * want to redirect to.
     *
     * @param {string} fnName - The name of the function on the new
     * controller that should process the request.
     *
     * @param {URLSearchParams} params - The URL query parameters to
     * pass into the constructor of the controller you are redirecting to.
     *
     */
    redirect(controllerName, fnName, params) {
        this.redirected = true;
        window.location.href = `#${controllerName}/${fnName}?${params.toString()}`;
        return this.noContent();
    }

    /**
     * This displays a blank form that allows a user to create a new
     * instance of an object.
     */
    new() {
        let form = new this.formClass(new this.model());
        let html = this.formTemplate({ form: form });
        return this.containerContent(html);
    }

    /**
     * This displays a HTML form with pre-filled values, so a user
     * can edit an existing object.
     */
    edit() {
        let obj = this.model.find(this.params.get('id'));
        let form = new this.formClass(obj);
        let html = this.formTemplate({ form: form });
        return this.containerContent(html);
    }

    /**
     * This handles the submission of a form, saving an object to the
     * local database if it's valid, or highlighting errors on the form
     * if the object is not valid.
     */
    update() {
        let obj = this.model.find(this.params.get('id')) || new this.model();
        let form = new this.formClass(obj);
        form.parseFromDOM();
        if (!form.obj.validate()) {
            form.setErrors();
            let html = this.formTemplate({ form: form });
            return this.containerContent(html);
        }
        this.alertMessage = Context.y18n.__(
            "ObjectSaved_message",
            Util.camelToTitle(obj.constructor.name),
            obj[this.nameProperty]);
        obj.save();
        return this.list();
    }

    /**
     * This displays a list of all instances of an object type from the local
     * database. It works with params limit, offset, orderBy, and sortDirection,
     * which are passed into the constructor in the params object.
     */
    list() {
        let listParams = this.paramsToHash();
        listParams.orderBy = listParams.sortBy || this.defaultOrderBy;
        listParams.sortDirection = listParams.sortOrder || this.defaultSortDirection;
        let items = this.model.list(null, listParams);
        let data = {
            alertMessage: this.alertMessage,
            items: items
        };
        let html = this.listTemplate(data);
        return this.containerContent(html);
    }

    /**
     * This deletes an object from the database, after prompting the user
     * to confirm they really want to delete it.
     */
    destroy() {
        let obj = this.model.find(this.params.get('id'));
        let confirmDeletionMessage = Context.y18n.__(
            "Confirm_deletion",
            Util.camelToTitle(obj.constructor.name),
            obj[this.nameProperty]);
        if (confirm(confirmDeletionMessage)) {
            this.alertMessage =Context.y18n.__(
                "ObjectDeleted_message",
                Util.camelToTitle(obj.constructor.name),
                obj[this.nameProperty]);
            obj.delete();
            return this.list();
        }
        return this.noContent();
    }

    /**
     * This is to be defined by derived classes as necessary.
     * It does nothing in the base class, but derived classes
     * can use it to attach event handlers to HTML elements
     * that have just been rendered.
     *
     * @param {string} fnName - The name of the function that was
     * called in the original request. The postRenderCallback may
     * include logic to perform different actions based on what
     * the user initially requested. For example, you may want to
     * attach one set of event handlers after rendering
     * Controller.new() and a different set after rendering
     * Controller.update().
     *
     */
    postRenderCallback(fnName) {

    }

}

module.exports.BaseController = BaseController;
</code></pre>
  </article>
</section>

    


  </div>

  <br class="clear">

  <footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a>
  </footer>

  <script src="scripts/linenumber.js"></script>
  <script src="scripts/pagelocation.js"></script>

  

</body>
</html>
